(window.webpackJsonp=window.webpackJsonp||[]).push([[373],{764:function(s,t,a){"use strict";a.r(t);var e=a(1),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"插件实现自动部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件实现自动部署"}},[s._v("#")]),s._v(" 插件实现自动部署")]),s._v(" "),t("h2",{attrs:{id:"🎯-目标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#🎯-目标"}},[s._v("#")]),s._v(" 🎯 目标")]),s._v(" "),t("p",[s._v("我们希望通过简单的命令：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run deploy\n")])])]),t("p",[s._v("就能自动：")]),s._v(" "),t("ul",[t("li",[s._v("构建项目（生成 "),t("code",[s._v("dist/")]),s._v(" 文件夹）")]),s._v(" "),t("li",[s._v("将 "),t("code",[s._v("dist/")]),s._v(" 推送到 GitHub 的 "),t("code",[s._v("gh-pages")]),s._v(" 分支")]),s._v(" "),t("li",[s._v("自动更新你托管在 GitHub Pages 的站点内容")])]),s._v(" "),t("h2",{attrs:{id:"✅-步骤详解-以-vue-vite-项目为例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#✅-步骤详解-以-vue-vite-项目为例"}},[s._v("#")]),s._v(" ✅ 步骤详解（以 Vue + Vite 项目为例）")]),s._v(" "),t("h3",{attrs:{id:"_1-安装-gh-pages-插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-gh-pages-插件"}},[s._v("#")]),s._v(" ① 安装 "),t("code",[s._v("gh-pages")]),s._v(" 插件")]),s._v(" "),t("p",[s._v("在项目根目录执行：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save-dev gh-pages\n")])])]),t("p",[s._v("这个插件就是用来把 "),t("code",[s._v("dist/")]),s._v(" 目录推送到 "),t("code",[s._v("gh-pages")]),s._v(" 分支的。")]),s._v(" "),t("h3",{attrs:{id:"_2-配置-vite-config-js"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置-vite-config-js"}},[s._v("#")]),s._v(" ② 配置 "),t("code",[s._v("vite.config.js")])]),s._v(" "),t("p",[s._v("添加 "),t("code",[s._v("base")]),s._v(" 配置项（必须！否则 GitHub Pages 路径不对）：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// vite.config.js")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" defineConfig "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vite'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("defineConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("base")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/你的仓库名/'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注意前后都有斜杠")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("例如你的仓库是 "),t("code",[s._v("https://github.com/lys123/vue-demo")]),s._v("，那么就写：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("base")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/vue-demo/'")]),s._v("\n")])])]),t("h3",{attrs:{id:"_3-修改-package-json-脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-修改-package-json-脚本"}},[s._v("#")]),s._v(" ③ 修改 "),t("code",[s._v("package.json")]),s._v(" 脚本")]),s._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vite build"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"predeploy"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm run build"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 自动在部署前构建")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"deploy"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gh-pages -d dist"')]),s._v("     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 推送 dist 目录到 gh-pages 分支")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("blockquote",[t("p",[t("code",[s._v("predeploy")]),s._v(" 是 Node 的生命周期钩子，会在你运行 "),t("code",[s._v("npm run deploy")]),s._v(" 时自动先运行 "),t("code",[s._v("npm run build")]),s._v("。")])]),s._v(" "),t("h3",{attrs:{id:"_4-初始化-git-并推送主分支-如果还没做"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-初始化-git-并推送主分支-如果还没做"}},[s._v("#")]),s._v(" ④ 初始化 Git 并推送主分支（如果还没做）")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"init"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" branch "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-M")]),s._v(" main\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" remote "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" origin https://github.com/你的用户名/你的仓库名.git\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" origin main\n")])])]),t("h3",{attrs:{id:"_5-执行部署命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-执行部署命令"}},[s._v("#")]),s._v(" ⑤ 执行部署命令")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run deploy\n")])])]),t("p",[s._v("控制台会显示它将 "),t("code",[s._v("dist/")]),s._v(" 推送到了 "),t("code",[s._v("gh-pages")]),s._v(" 分支。")]),s._v(" "),t("h3",{attrs:{id:"_6-在-github-上启用-pages"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-在-github-上启用-pages"}},[s._v("#")]),s._v(" ⑥ 在 GitHub 上启用 Pages")]),s._v(" "),t("ol",[t("li",[s._v("打开你的 GitHub 仓库")]),s._v(" "),t("li",[s._v("进入 "),t("code",[s._v("Settings")]),s._v(" → "),t("code",[s._v("Pages")])]),s._v(" "),t("li",[s._v("在 "),t("code",[s._v("Source")]),s._v(" 中选择："),t("code",[s._v("gh-pages")]),s._v(" 分支 → "),t("code",[s._v("/ (root)")])]),s._v(" "),t("li",[s._v("保存后，GitHub 会生成访问链接，如：")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("https://你的用户名.github.io/你的仓库名/\n")])])]),t("h2",{attrs:{id:"✅-总结一张图-流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#✅-总结一张图-流程"}},[s._v("#")]),s._v(" ✅ 总结一张图（流程）")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("npm run deploy\n   ↓\nnpm run build（自动）\n   ↓\nvite 构建出 dist/\n   ↓\ngh-pages 把 dist/ 推送到 gh-pages 分支\n   ↓\nGitHub Pages 使用 gh-pages 分支作为网站源\n   ↓\n网站上线 🎉\n")])])]),t("h2",{attrs:{id:"🔁-后续更新内容怎么办"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#🔁-后续更新内容怎么办"}},[s._v("#")]),s._v(" 🔁 后续更新内容怎么办？")]),s._v(" "),t("p",[s._v("你只需要改完代码后再次执行：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run deploy\n")])])]),t("p",[s._v("即可自动部署最新版网站。")])])}),[],!1,null,null,null);t.default=n.exports}}]);