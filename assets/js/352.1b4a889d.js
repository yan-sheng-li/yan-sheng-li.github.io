(window.webpackJsonp=window.webpackJsonp||[]).push([[352],{741:function(t,e,s){"use strict";s.r(e);var a=s(0),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("blockquote",[e("p",[e("code",[t._v("vuex-persistedstate")]),t._v(" 是一个用于 "),e("strong",[t._v("持久化 Vuex 状态")]),t._v(" 的插件，可以将 Vuex 中的数据自动保存到本地存储（如 "),e("code",[t._v("localStorage")]),t._v(" 或 "),e("code",[t._v("sessionStorage")]),t._v("），防止页面刷新后数据丢失。以下是它在 "),e("strong",[t._v("Vue 2 项目")]),t._v("中的详细使用指南：")])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"_1-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装"}},[t._v("#")]),t._v(" "),e("strong",[t._v("1. 安装")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm install vuex-persistedstate\n# 或\nyarn add vuex-persistedstate\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"_2-基本使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-基本使用"}},[t._v("#")]),t._v(" "),e("strong",[t._v("2. 基本使用")])]),t._v(" "),e("h3",{attrs:{id:"_2-1-在-vuex-store-中引入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-在-vuex-store-中引入"}},[t._v("#")]),t._v(" "),e("strong",[t._v("2.1 在 Vuex Store 中引入")])]),t._v(" "),e("p",[t._v("在 "),e("code",[t._v("store/index.js")]),t._v("（或你的 Vuex 配置文件）中引入并配置：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import Vue from 'vue';\nimport Vuex from 'vuex';\nimport createPersistedState from 'vuex-persistedstate';\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {\n    user: null,\n    token: '',\n    theme: 'light',\n  },\n  mutations: {\n    setUser(state, user) {\n      state.user = user;\n    },\n    setToken(state, token) {\n      state.token = token;\n    },\n    setTheme(state, theme) {\n      state.theme = theme;\n    },\n  },\n  plugins: [\n    // 默认使用 localStorage 存储所有 state\n    createPersistedState(),\n  ],\n});\n")])])]),e("h3",{attrs:{id:"_2-2-测试效果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-测试效果"}},[t._v("#")]),t._v(" "),e("strong",[t._v("2.2 测试效果")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("在 Vue 组件中修改 Vuex 状态：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("this.$store.commit('setUser', { name: 'John' });\nthis.$store.commit('setToken', 'abc123');\n")])])])]),t._v(" "),e("li")]),t._v(" "),e("p",[t._v("刷新页面")]),t._v(" "),e("p",[t._v("，检查")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("localStorage\n")])])]),e("p",[t._v("（开发者工具 → Application → Local Storage），会发现数据已被保存：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n  "user": { "name": "John" },\n  "token": "abc123",\n  "theme": "light"\n}\n')])])]),e("ul",[e("li",[t._v("重新加载页面后，Vuex 会自动从 "),e("code",[t._v("localStorage")]),t._v(" 恢复数据。")])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"_3-高级配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-高级配置"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3. 高级配置")])]),t._v(" "),e("h3",{attrs:{id:"_3-1-只持久化部分-state"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-只持久化部分-state"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.1 只持久化部分 state")])]),t._v(" "),e("p",[t._v("如果不想保存全部 state，可以指定 "),e("code",[t._v("paths")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("createPersistedState({\n  paths: ['user', 'token'], // 只保存 user 和 token\n}),\n")])])]),e("h3",{attrs:{id:"_3-2-使用-sessionstorage"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-使用-sessionstorage"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.2 使用 sessionStorage")])]),t._v(" "),e("p",[t._v("默认使用 "),e("code",[t._v("localStorage")]),t._v("，如果想改用 "),e("code",[t._v("sessionStorage")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("createPersistedState({\n  storage: window.sessionStorage,\n}),\n")])])]),e("h3",{attrs:{id:"_3-3-自定义存储-key"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-自定义存储-key"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.3 自定义存储 key")])]),t._v(" "),e("p",[t._v("默认存储 key 是 "),e("code",[t._v("vuex")]),t._v("，可以修改：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("createPersistedState({\n  key: 'my-app-vuex', // localStorage 中的 key 会变成 \"my-app-vuex\"\n}),\n")])])]),e("h3",{attrs:{id:"_3-4-数据加密-可选"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-数据加密-可选"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.4 数据加密（可选）")])]),t._v(" "),e("p",[t._v("如果需要加密存储的数据，可以使用 "),e("code",[t._v("secure-ls")]),t._v("：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm install secure-ls\nimport SecureLS from 'secure-ls';\nconst ls = new SecureLS({ encodingType: 'aes' });\n\ncreatePersistedState({\n  storage: {\n    getItem: (key) => ls.get(key),\n    setItem: (key, value) => ls.set(key, value),\n    removeItem: (key) => ls.remove(key),\n  },\n}),\n")])])]),e("h3",{attrs:{id:"_3-5-数据过滤-不存储某些数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-数据过滤-不存储某些数据"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.5 数据过滤（不存储某些数据）")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("createPersistedState({\n  reducer: (state) => {\n    const { token, ...persistedState } = state; // 不存储 token\n    return persistedState;\n  },\n}),\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"_4-常见问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-常见问题"}},[t._v("#")]),t._v(" "),e("strong",[t._v("4. 常见问题")])]),t._v(" "),e("h3",{attrs:{id:"_4-1-数据未更新"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-数据未更新"}},[t._v("#")]),t._v(" "),e("strong",[t._v("4.1 数据未更新？")])]),t._v(" "),e("ul",[e("li",[t._v("确保 "),e("code",[t._v("mutations")]),t._v(" 正确触发，并且 "),e("code",[t._v("createPersistedState")]),t._v(" 在 "),e("code",[t._v("plugins")]),t._v(" 数组中。")]),t._v(" "),e("li",[t._v("检查 "),e("code",[t._v("localStorage")]),t._v(" 是否被浏览器禁用（如隐私模式）。")])]),t._v(" "),e("h3",{attrs:{id:"_4-2-如何清除存储的数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-如何清除存储的数据"}},[t._v("#")]),t._v(" "),e("strong",[t._v("4.2 如何清除存储的数据？")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// 手动清除 localStorage 中的 Vuex 数据\nlocalStorage.removeItem('vuex'); // 或自定义的 key\n// 或\nthis.$store.replaceState({}); // 重置 Vuex 状态\n")])])]),e("h3",{attrs:{id:"_4-3-兼容-ssr-如-nuxt-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-兼容-ssr-如-nuxt-js"}},[t._v("#")]),t._v(" "),e("strong",[t._v("4.3 兼容 SSR（如 Nuxt.js）")])]),t._v(" "),e("p",[t._v("在 SSR 环境下（如 Nuxt.js），"),e("code",[t._v("window")]),t._v(" 对象不存在，需要动态引入：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// 仅在客户端使用\nif (process.client) {\n  const createPersistedState = require('vuex-persistedstate').default;\n  store.plugins.push(createPersistedState());\n}\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"_5-官方文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-官方文档"}},[t._v("#")]),t._v(" "),e("strong",[t._v("5. 官方文档")])]),t._v(" "),e("ul",[e("li",[t._v("GitHub: https://github.com/robinvdvleuten/vuex-persistedstate")]),t._v(" "),e("li",[t._v("更多配置选项："),e("code",[t._v("createPersistedState(options)")])])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" "),e("strong",[t._v("总结")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("功能")]),t._v(" "),e("th",[t._v("配置方式")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[t._v("基本存储")])]),t._v(" "),e("td",[e("code",[t._v("createPersistedState()")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("只存储部分 state")])]),t._v(" "),e("td",[e("code",[t._v("paths: ['user', 'token']")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("改用 sessionStorage")])]),t._v(" "),e("td",[e("code",[t._v("storage: window.sessionStorage")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("自定义 key")])]),t._v(" "),e("td",[e("code",[t._v("key: 'my-custom-key'")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("加密存储")])]),t._v(" "),e("td",[t._v("结合 "),e("code",[t._v("secure-ls")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("数据过滤")])]),t._v(" "),e("td",[e("code",[t._v("reducer: (state) => filteredState")])])])])]),t._v(" "),e("p",[t._v("通过 "),e("code",[t._v("vuex-persistedstate")]),t._v("，你可以轻松实现 Vuex 数据的持久化，提升用户体验！ 🚀")])])}),[],!1,null,null,null);e.default=r.exports}}]);