(window.webpackJsonp=window.webpackJsonp||[]).push([[352],{741:function(t,e,s){"use strict";s.r(e);var a=s(0),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("blockquote",[e("p",[e("code",[t._v("vuex-persistedstate")]),t._v(" æ˜¯ä¸€ä¸ªç”¨äº "),e("strong",[t._v("æŒä¹…åŒ– Vuex çŠ¶æ€")]),t._v(" çš„æ’ä»¶ï¼Œå¯ä»¥å°† Vuex ä¸­çš„æ•°æ®è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ï¼ˆå¦‚ "),e("code",[t._v("localStorage")]),t._v(" æˆ– "),e("code",[t._v("sessionStorage")]),t._v("ï¼‰ï¼Œé˜²æ­¢é¡µé¢åˆ·æ–°åæ•°æ®ä¸¢å¤±ã€‚ä»¥ä¸‹æ˜¯å®ƒåœ¨ "),e("strong",[t._v("Vue 2 é¡¹ç›®")]),t._v("ä¸­çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼š")])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"_1-å®‰è£…"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-å®‰è£…"}},[t._v("#")]),t._v(" "),e("strong",[t._v("1. å®‰è£…")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm install vuex-persistedstate\n# æˆ–\nyarn add vuex-persistedstate\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"_2-åŸºæœ¬ä½¿ç”¨"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-åŸºæœ¬ä½¿ç”¨"}},[t._v("#")]),t._v(" "),e("strong",[t._v("2. åŸºæœ¬ä½¿ç”¨")])]),t._v(" "),e("h3",{attrs:{id:"_2-1-åœ¨-vuex-store-ä¸­å¼•å…¥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-åœ¨-vuex-store-ä¸­å¼•å…¥"}},[t._v("#")]),t._v(" "),e("strong",[t._v("2.1 åœ¨ Vuex Store ä¸­å¼•å…¥")])]),t._v(" "),e("p",[t._v("åœ¨ "),e("code",[t._v("store/index.js")]),t._v("ï¼ˆæˆ–ä½ çš„ Vuex é…ç½®æ–‡ä»¶ï¼‰ä¸­å¼•å…¥å¹¶é…ç½®ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import Vue from 'vue';\nimport Vuex from 'vuex';\nimport createPersistedState from 'vuex-persistedstate';\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {\n    user: null,\n    token: '',\n    theme: 'light',\n  },\n  mutations: {\n    setUser(state, user) {\n      state.user = user;\n    },\n    setToken(state, token) {\n      state.token = token;\n    },\n    setTheme(state, theme) {\n      state.theme = theme;\n    },\n  },\n  plugins: [\n    // é»˜è®¤ä½¿ç”¨ localStorage å­˜å‚¨æ‰€æœ‰ state\n    createPersistedState(),\n  ],\n});\n")])])]),e("h3",{attrs:{id:"_2-2-æµ‹è¯•æ•ˆæœ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-æµ‹è¯•æ•ˆæœ"}},[t._v("#")]),t._v(" "),e("strong",[t._v("2.2 æµ‹è¯•æ•ˆæœ")])]),t._v(" "),e("ul",[e("li",[e("p",[t._v("åœ¨ Vue ç»„ä»¶ä¸­ä¿®æ”¹ Vuex çŠ¶æ€ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("this.$store.commit('setUser', { name: 'John' });\nthis.$store.commit('setToken', 'abc123');\n")])])])]),t._v(" "),e("li")]),t._v(" "),e("p",[t._v("åˆ·æ–°é¡µé¢")]),t._v(" "),e("p",[t._v("ï¼Œæ£€æŸ¥")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("localStorage\n")])])]),e("p",[t._v("ï¼ˆå¼€å‘è€…å·¥å…· â†’ Application â†’ Local Storageï¼‰ï¼Œä¼šå‘ç°æ•°æ®å·²è¢«ä¿å­˜ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n  "user": { "name": "John" },\n  "token": "abc123",\n  "theme": "light"\n}\n')])])]),e("ul",[e("li",[t._v("é‡æ–°åŠ è½½é¡µé¢åï¼ŒVuex ä¼šè‡ªåŠ¨ä» "),e("code",[t._v("localStorage")]),t._v(" æ¢å¤æ•°æ®ã€‚")])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"_3-é«˜çº§é…ç½®"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-é«˜çº§é…ç½®"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3. é«˜çº§é…ç½®")])]),t._v(" "),e("h3",{attrs:{id:"_3-1-åªæŒä¹…åŒ–éƒ¨åˆ†-state"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-åªæŒä¹…åŒ–éƒ¨åˆ†-state"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.1 åªæŒä¹…åŒ–éƒ¨åˆ† state")])]),t._v(" "),e("p",[t._v("å¦‚æœä¸æƒ³ä¿å­˜å…¨éƒ¨ stateï¼Œå¯ä»¥æŒ‡å®š "),e("code",[t._v("paths")]),t._v("ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("createPersistedState({\n  paths: ['user', 'token'], // åªä¿å­˜ user å’Œ token\n}),\n")])])]),e("h3",{attrs:{id:"_3-2-ä½¿ç”¨-sessionstorage"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-ä½¿ç”¨-sessionstorage"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.2 ä½¿ç”¨ sessionStorage")])]),t._v(" "),e("p",[t._v("é»˜è®¤ä½¿ç”¨ "),e("code",[t._v("localStorage")]),t._v("ï¼Œå¦‚æœæƒ³æ”¹ç”¨ "),e("code",[t._v("sessionStorage")]),t._v("ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("createPersistedState({\n  storage: window.sessionStorage,\n}),\n")])])]),e("h3",{attrs:{id:"_3-3-è‡ªå®šä¹‰å­˜å‚¨-key"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-è‡ªå®šä¹‰å­˜å‚¨-key"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.3 è‡ªå®šä¹‰å­˜å‚¨ key")])]),t._v(" "),e("p",[t._v("é»˜è®¤å­˜å‚¨ key æ˜¯ "),e("code",[t._v("vuex")]),t._v("ï¼Œå¯ä»¥ä¿®æ”¹ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("createPersistedState({\n  key: 'my-app-vuex', // localStorage ä¸­çš„ key ä¼šå˜æˆ \"my-app-vuex\"\n}),\n")])])]),e("h3",{attrs:{id:"_3-4-æ•°æ®åŠ å¯†-å¯é€‰"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-æ•°æ®åŠ å¯†-å¯é€‰"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.4 æ•°æ®åŠ å¯†ï¼ˆå¯é€‰ï¼‰")])]),t._v(" "),e("p",[t._v("å¦‚æœéœ€è¦åŠ å¯†å­˜å‚¨çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ "),e("code",[t._v("secure-ls")]),t._v("ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm install secure-ls\nimport SecureLS from 'secure-ls';\nconst ls = new SecureLS({ encodingType: 'aes' });\n\ncreatePersistedState({\n  storage: {\n    getItem: (key) => ls.get(key),\n    setItem: (key, value) => ls.set(key, value),\n    removeItem: (key) => ls.remove(key),\n  },\n}),\n")])])]),e("h3",{attrs:{id:"_3-5-æ•°æ®è¿‡æ»¤-ä¸å­˜å‚¨æŸäº›æ•°æ®"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-æ•°æ®è¿‡æ»¤-ä¸å­˜å‚¨æŸäº›æ•°æ®"}},[t._v("#")]),t._v(" "),e("strong",[t._v("3.5 æ•°æ®è¿‡æ»¤ï¼ˆä¸å­˜å‚¨æŸäº›æ•°æ®ï¼‰")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("createPersistedState({\n  reducer: (state) => {\n    const { token, ...persistedState } = state; // ä¸å­˜å‚¨ token\n    return persistedState;\n  },\n}),\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"_4-å¸¸è§é—®é¢˜"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-å¸¸è§é—®é¢˜"}},[t._v("#")]),t._v(" "),e("strong",[t._v("4. å¸¸è§é—®é¢˜")])]),t._v(" "),e("h3",{attrs:{id:"_4-1-æ•°æ®æœªæ›´æ–°"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-æ•°æ®æœªæ›´æ–°"}},[t._v("#")]),t._v(" "),e("strong",[t._v("4.1 æ•°æ®æœªæ›´æ–°ï¼Ÿ")])]),t._v(" "),e("ul",[e("li",[t._v("ç¡®ä¿ "),e("code",[t._v("mutations")]),t._v(" æ­£ç¡®è§¦å‘ï¼Œå¹¶ä¸” "),e("code",[t._v("createPersistedState")]),t._v(" åœ¨ "),e("code",[t._v("plugins")]),t._v(" æ•°ç»„ä¸­ã€‚")]),t._v(" "),e("li",[t._v("æ£€æŸ¥ "),e("code",[t._v("localStorage")]),t._v(" æ˜¯å¦è¢«æµè§ˆå™¨ç¦ç”¨ï¼ˆå¦‚éšç§æ¨¡å¼ï¼‰ã€‚")])]),t._v(" "),e("h3",{attrs:{id:"_4-2-å¦‚ä½•æ¸…é™¤å­˜å‚¨çš„æ•°æ®"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-å¦‚ä½•æ¸…é™¤å­˜å‚¨çš„æ•°æ®"}},[t._v("#")]),t._v(" "),e("strong",[t._v("4.2 å¦‚ä½•æ¸…é™¤å­˜å‚¨çš„æ•°æ®ï¼Ÿ")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// æ‰‹åŠ¨æ¸…é™¤ localStorage ä¸­çš„ Vuex æ•°æ®\nlocalStorage.removeItem('vuex'); // æˆ–è‡ªå®šä¹‰çš„ key\n// æˆ–\nthis.$store.replaceState({}); // é‡ç½® Vuex çŠ¶æ€\n")])])]),e("h3",{attrs:{id:"_4-3-å…¼å®¹-ssr-å¦‚-nuxt-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-å…¼å®¹-ssr-å¦‚-nuxt-js"}},[t._v("#")]),t._v(" "),e("strong",[t._v("4.3 å…¼å®¹ SSRï¼ˆå¦‚ Nuxt.jsï¼‰")])]),t._v(" "),e("p",[t._v("åœ¨ SSR ç¯å¢ƒä¸‹ï¼ˆå¦‚ Nuxt.jsï¼‰ï¼Œ"),e("code",[t._v("window")]),t._v(" å¯¹è±¡ä¸å­˜åœ¨ï¼Œéœ€è¦åŠ¨æ€å¼•å…¥ï¼š")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// ä»…åœ¨å®¢æˆ·ç«¯ä½¿ç”¨\nif (process.client) {\n  const createPersistedState = require('vuex-persistedstate').default;\n  store.plugins.push(createPersistedState());\n}\n")])])]),e("hr"),t._v(" "),e("h2",{attrs:{id:"_5-å®˜æ–¹æ–‡æ¡£"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-å®˜æ–¹æ–‡æ¡£"}},[t._v("#")]),t._v(" "),e("strong",[t._v("5. å®˜æ–¹æ–‡æ¡£")])]),t._v(" "),e("ul",[e("li",[t._v("GitHub: https://github.com/robinvdvleuten/vuex-persistedstate")]),t._v(" "),e("li",[t._v("æ›´å¤šé…ç½®é€‰é¡¹ï¼š"),e("code",[t._v("createPersistedState(options)")])])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"æ€»ç»“"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[t._v("#")]),t._v(" "),e("strong",[t._v("æ€»ç»“")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("åŠŸèƒ½")]),t._v(" "),e("th",[t._v("é…ç½®æ–¹å¼")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("strong",[t._v("åŸºæœ¬å­˜å‚¨")])]),t._v(" "),e("td",[e("code",[t._v("createPersistedState()")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("åªå­˜å‚¨éƒ¨åˆ† state")])]),t._v(" "),e("td",[e("code",[t._v("paths: ['user', 'token']")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("æ”¹ç”¨ sessionStorage")])]),t._v(" "),e("td",[e("code",[t._v("storage: window.sessionStorage")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("è‡ªå®šä¹‰ key")])]),t._v(" "),e("td",[e("code",[t._v("key: 'my-custom-key'")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("åŠ å¯†å­˜å‚¨")])]),t._v(" "),e("td",[t._v("ç»“åˆ "),e("code",[t._v("secure-ls")])])]),t._v(" "),e("tr",[e("td",[e("strong",[t._v("æ•°æ®è¿‡æ»¤")])]),t._v(" "),e("td",[e("code",[t._v("reducer: (state) => filteredState")])])])])]),t._v(" "),e("p",[t._v("é€šè¿‡ "),e("code",[t._v("vuex-persistedstate")]),t._v("ï¼Œä½ å¯ä»¥è½»æ¾å®ç° Vuex æ•°æ®çš„æŒä¹…åŒ–ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼ ğŸš€")])])}),[],!1,null,null,null);e.default=r.exports}}]);